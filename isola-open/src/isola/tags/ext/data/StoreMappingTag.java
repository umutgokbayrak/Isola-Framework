package isola.tags.ext.data;import javax.servlet.jsp.JspException;import isola.model.core.JsFunction;import isola.model.core.JsObject;import isola.tags.base.BaseTag;/** *  * Used for parameterazing the data in a data store and assigning keys to the * mappings. *  *  *  * @see ArrayStoreTag *  * @see JsonStoreTag *  * @see XmlStoreTag *  * @see ContextStoreTag *  * @author Umut Gokbayrak */public class StoreMappingTag extends BaseTag {	private static final long serialVersionUID = -2775694906959821394L;	private String name;	private String type;	private String mapping;	private String sortType;	private String sortDir;	private String convert;	private String dateFormat;		@Override	public int doEndTag() throws JspException {		JsObject obj = new JsObject();		prepareConfig(obj);		// insert item to the parent storetag		if (getParent() instanceof StoreTag) {			StoreTag st = (StoreTag) getParent();			st.getFields().add(obj);		}		clear();		return EVAL_PAGE;	}		@Override	protected void clear() {		name = sortType = sortDir = null;		type = convert = dateFormat = null;		mapping = null;	}		/**	 * 	 * 	 * 	 * @param obj	 */	protected void prepareConfig(JsObject obj) {		if (name != null) {			obj.put("name", name);		}		if (type != null) {			obj.put("type", type);		}		if (mapping != null) {			obj.put("mapping", mapping);		}		if (sortType != null) {			obj.put("sortType", sortType);		}		if (sortDir != null) {			obj.put("sortDir", sortDir);		}		if (convert != null) {			try {				obj.put("convert", new JsFunction(convert));			} catch (Exception e) {}		}		if (dateFormat != null) {			obj.put("dateFormat", dateFormat);		}	}		public void setName(String name) {		this.name = name;	}		public void setType(String type) {		this.type = type;	}		public void setMapping(String mapping) {		this.mapping = mapping;	}		public void setSortType(String sortType) {		this.sortType = sortType;	}		public void setSortDir(String sortDir) {		this.sortDir = sortDir;	}		public void setConvert(String convert) {		this.convert = convert;	}		public void setDateFormat(String dateFormat) {		this.dateFormat = dateFormat;	}}