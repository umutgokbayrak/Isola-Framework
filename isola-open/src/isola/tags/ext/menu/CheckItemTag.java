package isola.tags.ext.menu;import javax.servlet.jsp.JspException;import isola.model.core.JsFunction;import isola.model.ext.base.Observable;import isola.model.ext.menu.CheckItem;/** *  * Adds a menu item that contains a checkbox by default, but can also be part of * a radio group. *  *  *  * @author Umut Gokbayrak */public class CheckItemTag extends ItemTag {	private static final long serialVersionUID = 2223688871783226239L;	private String checked;	private String group;	private String groupClass;	private String onBeforeCheckChange;	private String onCheckChange;		@Override	public int doEndTag() throws JspException {		CheckItem obj = new CheckItem();		prepareConfig(obj);		// manage listeners		prepareEvents(obj);		// print the output		printOut(obj);		return EVAL_PAGE;	}		@Override	public void clear() {		super.clear();		checked = "false";		group = groupClass = onBeforeCheckChange = onCheckChange = null;	}		/**	 * 	 * 	 * 	 * @param obj	 */	protected void prepareConfig(CheckItem obj) {		super.prepareConfig(obj);		if (checked != null) {			try {				obj.checked = Boolean.valueOf(checked);			} catch (Exception e) {			}		}		obj.group = group;		obj.groupClass = groupClass;	}		@Override	protected void prepareEvents(Observable obj) {		super.prepareEvents(obj);		if (onBeforeCheckChange != null) {			obj.listeners.put("beforecheckchange", new JsFunction(onBeforeCheckChange));		}		if (onCheckChange != null) {			obj.listeners.put("checkchange", new JsFunction(onCheckChange));		}	}		/**	 * 	 * True to initialize this checkbox as checked (defaults to false). Note	 * that if this checkbox	 * 	 * is part of a radio group (group = true) only the last item in the group	 * that is initialized	 * 	 * with checked = true will be rendered as checked.	 */	public void setChecked(String checked) {		this.checked = checked;	}		/**	 * 	 * All check items with the same group name will automatically be grouped	 * into a single-select	 * 	 * radio button group (defaults to '')	 */	public void setGroup(String group) {		this.group = group;	}		/**	 * 	 * The default CSS class to use for radio group check items (defaults to	 * "x-menu-group-item")	 */	public void setGroupClass(String groupClass) {		this.groupClass = groupClass;	}		/**	 * 	 * <p>	 * Fires before the checked value is set, providing an opportunity to cancel	 * if needed	 * </p>	 * 	 * Listeners will be called with the following arguments:	 * 	 * <ul>	 * 	 * <li><strong>this</strong> : Ext.menu.CheckItem</li>	 * 	 * <li><strong>checked</strong> : (Boolean) The new checked value that will	 * be set</li>	 * 	 * </ul>	 * 	 * @param onBeforeCheckChange	 */	public void setOnBeforeCheckChange(String onBeforeCheckChange) {		this.onBeforeCheckChange = onBeforeCheckChange;	}		/**	 * 	 * <p>	 * Fires after the checked value has been set	 * </p>	 * 	 * Listeners will be called with the following arguments:	 * 	 * <ul>	 * 	 * <li><strong>this</strong> : Ext.menu.CheckItem</li>	 * 	 * <li><strong>checked</strong> : (Boolean) The checked value that was set</li>	 * 	 * </ul>	 * 	 * @param onCheckChange	 */	public void setOnCheckChange(String onCheckChange) {		this.onCheckChange = onCheckChange;	}}